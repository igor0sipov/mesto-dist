(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._selectorsObject=e,this._currentForm=n,this._inputList=Array.from(n.querySelectorAll(this._selectorsObject.input))}var n,r;return n=t,(r=[{key:"_showError",value:function(e){this._errorElement=this._currentForm.querySelector(".".concat(e.id,"-error")),e.classList.add(this._selectorsObject.inputError),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._selectorsObject.errorVisible)}},{key:"_hideError",value:function(e){this._errorElement=this._currentForm.querySelector(".".concat(e.id,"-error")),e.classList.remove(this._selectorsObject.inputError),this._errorElement.textContent="",this._errorElement.classList.remove(this._selectorsObject.errorVisible)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideError(e):this._showError(e)}},{key:"_hasInpvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){var e=this._currentForm.querySelector(this._selectorsObject.submitButton);this._hasInpvalidInput()?(e.setAttribute("disabled","true"),e.classList.add(this._selectorsObject.inactiveButton)):(e.classList.remove(this._selectorsObject.inactiveButton),e.removeAttribute("disabled"))}},{key:"_setListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"validate",value:function(){var e=this;this._inputList.forEach((function(t){e._checkInputValidity(t),e._toggleButtonState()}))}},{key:"clear",value:function(){var e=this;this._inputList.forEach((function(t){e._hideError(t)}))}},{key:"enableValidation",value:function(){this._currentForm.addEventListener("submit",(function(e){e.preventDefault()})),this._setListeners()}}])&&e(n.prototype,r),t}(),n=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__name"),o=document.querySelector(".profile__bio"),i=document.querySelector(".edit-profile"),c=document.forms.editProfileForm,u=document.querySelector(".profile__add-button"),a=document.querySelector(".add-place"),s=document.forms.addPlaceForm,l=document.querySelector(".elements"),f=document.querySelector(".fullsize-picture"),p={form:".form",input:".popup__input",submitButton:".popup__submit-button",inactiveButton:"popup__submit-button_disabled",inputError:"popup__input_type_error",errorVisible:"popup__input-error_visible"},h={cardTemplate:".card-template",card:".element",picture:".element__picture",title:".element__name",likeButton:".element__like-button",likeButtonActive:"element__like-button_active",deleteButton:".element__delete-button"},_={openedPopup:"popup_opened",form:".form",closeButton:".popup__close-icon",title:"popup__title",picture:".popup__picture",input:".popup__input",submitButton:".popup__submit-button",caption:".popup__caption"};function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=t,this._selectors=n,this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add(this._selectors.openedPopup),document.addEventListener("keyup",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove(this._selectors.openedPopup),document.removeEventListener("keyup",this._handleEscClose)}},{key:"_closeByOverlay",value:function(e){e.target===e.currentTarget&&this.close()}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.querySelector(this._selectors.closeButton).addEventListener("click",(function(){e.close()})),this._popup.addEventListener("click",(function(t){e._closeByOverlay(t)}))}}])&&m(t.prototype,n),e}();function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(c,e);var t,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(o){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return k(this,e)});function c(e,t){var n,r=e.popup,o=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=i.call(this,r,t))._form=n._popup.querySelector(n._selectors.form),n._handleFormSubmit=o,n}return t=c,(n=[{key:"_getInputValues",value:function(){var e=Array.from(this._form.querySelectorAll(this._selectors.input)),t={};return e.forEach((function(e){t["".concat(e.name)]=e.value})),t}},{key:"_submitHandler",value:function(e){e.preventDefault();var t=this._getInputValues();this._handleFormSubmit(t)}},{key:"close",value:function(){b(E(c.prototype),"close",this).call(this),this._form.reset()}},{key:"setEventListeners",value:function(){b(E(c.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("submit",this._submitHandler.bind(this))}}])&&v(t.prototype,n),c}(y);function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(t){var n=t.name,r=t.bio;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=n,this._bio=r}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,bio:this._bio.textContent}}},{key:"setUserInfo",value:function(e){var t=e.newName,n=e.newBio;this._name.textContent=t,this._bio.textContent=n}}])&&O(t.prototype,n),e}();function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=function(){function e(t,n){var r=t.data,o=t.handleCardClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._handleCardClick=o,this._title=r.title,this._image=r.image,this._alt=r.alt,this._selectors=n}var t,n;return t=e,(n=[{key:"_openFullsizePhoto",value:function(){this._handleCardClick({image:this._image,title:this._title})}},{key:"_removePlace",value:function(e){e.target.closest(this._selectors.card).remove()}},{key:"_activateLike",value:function(e){e.target.classList.toggle(this._selectors.likeButtonActive)}},{key:"_getTemplate",value:function(){return document.querySelector(this._selectors.cardTemplate).content.cloneNode(!0)}},{key:"_setListeners",value:function(){var e=this;this._element=this._getTemplate(),this._element.querySelector(this._selectors.picture).addEventListener("click",this._openFullsizePhoto.bind(this)),this._element.querySelector(this._selectors.deleteButton).addEventListener("click",(function(t){e._removePlace(t)})),this._element.querySelector(this._selectors.likeButton).addEventListener("click",(function(t){e._activateLike(t)}))}},{key:"initializeCard",value:function(){this._element=this._getTemplate(),this._setListeners();var e=this._element.querySelector(this._selectors.picture);return this._element.querySelector(this._selectors.title).textContent=this._title,e.src=this._image,e.alt=this._alt,this._element}}])&&j(t.prototype,n),e}();function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderedItems=r,this._renderer=o,this._container=n}var t,n;return t=e,(n=[{key:"addItem",value:function(e){this._container.prepend(e)}},{key:"renderItems",value:function(){var e=this;this._renderedItems.forEach((function(t){e._renderer(t)}))}}])&&C(t.prototype,n),e}();function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t,n){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=F(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(c,e);var t,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=F(r);if(o){var n=F(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return T(this,e)});function c(){return B(this,c),i.apply(this,arguments)}return t=c,(n=[{key:"open",value:function(e,t){var n=this._popup.querySelector(this._selectors.picture),r=this._popup.querySelector(this._selectors.caption);n.src=e,r.textContent=t,n.alt=t,I(F(c.prototype),"open",this).call(this)}}])&&x(t.prototype,n),c}(y),V=new t(p,c);V.enableValidation();var A=new t(p,s);A.enableValidation();var H=new S({name:r,bio:o}),M=new w({popup:i,handleFormSubmit:function(e){H.setUserInfo({newName:e.name,newBio:e.bio}),M.close()}},_);M.setEventListeners();var Q=function(e){var t=new P({items:e,renderer:function(e){var n=new L({data:e,handleCardClick:function(e){var t=e.image,n=e.title;J.open(t,n)}},h).initializeCard();t.addItem(n)}},l);t.renderItems()},z=new w({popup:a,handleFormSubmit:function(e){Q([{title:e.title,image:e.url,alt:e.title}]),z.close()}},_);z.setEventListeners();var J=new D(f,_);J.setEventListeners(),n.addEventListener("click",(function(){var e=H.getUserInfo();c.elements.name.value=e.name,c.elements.bio.value=e.bio,V.validate(),M.open()})),u.addEventListener("click",(function(){A.validate(),A.clear(),z.open()})),Q([{title:"Алтай",image:"https://images.unsplash.com/photo-1500101460942-f91854be42e4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1267&q=80",alt:"Дорога в хвойном лесу"},{title:"Екатеринбург",image:"https://images.unsplash.com/photo-1526722021192-1c0dc9b0921d?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1489&q=80",alt:"Фото Екатеринбурга с высоты"},{title:"Кинерма",image:"https://images.unsplash.com/photo-1559029884-4e34093db5b7?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjIxMTIzfQ&auto=format&fit=crop&w=1349&q=80",alt:"Два деревянных домика, идет снег"},{title:"Калуга",image:"https://images.unsplash.com/photo-1505551071487-d4a3fd384857?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1489&q=80",alt:"Река в лесу окутана туманом"},{title:"Хийденсельга",image:"https://images.unsplash.com/photo-1559029884-e95924923629?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80",alt:"Два деревянных домика в снегу у реки на берегу котрой лодка"},{title:"Дунилово",image:"https://images.unsplash.com/photo-1570579425144-46bcf064db84?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=675&q=80",alt:"Церковь среди деревьев в поле"}])})();